# workflow-processor-node

**Repository Name:** InvokeAI Workflow Processor Node

**Author:** dwringer

**License:** MIT

**Requirements:**
- invokeai>=4

## Introduction
The Enqueue Workflow Batch node operates by applying user updates to a pre-defined payload and sending it directly to the InvokeAI backend API using http.client. The node loads an example payload JSON (as generated by the frontend), uses it to create a pydantic schema, and then uses that to validate a given ordered list of linear UI input values, in a structure like:
```
[
 {"prompt": "a portrait of a housecat wearing a tie and business attire"},
 {"value": 1728},
 {"value": 1152},
 {"seed": 700},
 {"num_steps": 4}
]
```

These structures can be input directly as strings, or created with a set of Field List Builder nodes. Every Field List Builder node has one `value` output and three inputs: `existing_json`, `field_name`, and `value`. These nodes are chained together by connecting the `value` output of one to the `existing_json` input of another, by which they can be sequenced in the order they appear in the workflow's linear UI panel.

Note that field names given can be either the base name as defined in the node itself, or the user-applied label (if it has been renamed). Either will work, with spaces or underscores, and is case insensitive. Duplicate names are no problem as long as they are properly ordered in the input updates JSON.

### Installation:

To install these nodes, simply place the folder containing this
repository's code (or just clone the repository yourself) into your
`invokeai/nodes` folder.

## Overview
### Nodes
- [Enqueue Workflow Batch](#enqueue-workflow-batch) - Enqueues a workflow batch by applying user updates to a pre-defined payload
- [Field List Builder - Board](#field-list-builder---board) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Boolean](#field-list-builder---boolean) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - CLIP Model](#field-list-builder---clip-model) - Builds or appends to a JSON list containing single key-value pair dictionaries, for a CLIP embed model.
- [Field List Builder - ControlLoRA](#field-list-builder---controllora) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - ControlNet](#field-list-builder---controlnet) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Float](#field-list-builder---float) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Float Collection](#field-list-builder---float-collection) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - FLUX Main Model](#field-list-builder---flux-main-model) - Builds or appends to a JSON list containing single key-value pair dictionaries, for a main model.
- [Field List Builder - FLUX VAE](#field-list-builder---flux-vae) - Builds or appends to a JSON list containing single key-value pair dictionaries, for a VAE model.
- [Field List Builder - Image](#field-list-builder---image) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Image Collection](#field-list-builder---image-collection) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Integer](#field-list-builder---integer) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Integer Collection](#field-list-builder---integer-collection) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - IP Adapter](#field-list-builder---ip-adapter) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - Join](#field-list-builder---join) - Concatenates two JSON lists.
- [Field List Builder - LoRA](#field-list-builder---lora) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - String](#field-list-builder---string) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - String Collection](#field-list-builder---string-collection) - Builds or appends to a JSON list containing single key-value pair dictionaries.
- [Field List Builder - T5 Model](#field-list-builder---t5-model) - Builds or appends to a JSON list containing single key-value pair dictionaries, for a T5 encoder model.

<details>
<summary>

### Output Definitions

</summary>

- `EnqueueWorkflowBatchOutput` - Output definition with 2 fields
</details>

## Nodes
### Enqueue Workflow Batch
**ID:** `enqueue_workflow_batch`

**Category:** system

**Tags:** batch, workflow, automation, api

**Version:** 1.0.0

**Description:** Enqueues a workflow batch by applying user updates to a pre-defined payload

and sending it directly to the InvokeAI backend API using http.client.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `workflow_payload_filename` | `str` | The filename of the enqueue_batch JSON payload (e.g., 'my_workflow_payload.json') located in the node's 'workflow_payloads' subdirectory. | None |
| `field_list_updates` | `str` | A JSON string containing updates for the workflow's exposed fields. Keys can be field_name_in_node (e.g., 'value', 'prompt') or field_label (e.g., 'Num Steps', 'Main Prompt'). Field labels are case-insensitive and support spaces as underscores (e.g., 'num_steps', 'Num_Steps', 'Num Steps'). Example: [{'value': 100}, {'Num Steps': 25}]. Use empty string '[]' or '{}' for no updates (will be parsed as empty list). | None |


</details>

<details>
<summary>

#### Output

</summary>

**Type:** `EnqueueWorkflowBatchOutput`

| Name | Type | Description |
| ---- | ---- | ----------- |
| `status` | `str` | Status of the enqueue operation (e.g., 'Success', 'Failed') |
| `message` | `str` | A descriptive message about the enqueue operation. |


</details>

---
### Field List Builder - Board
**ID:** `field_list_builder_board`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, board

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Boolean
**ID:** `field_list_builder_boolean`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, boolean

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `value` | `bool` | The value for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - CLIP Model
**ID:** `field_list_builder_clip_model`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, clip, encoder

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries, for a CLIP embed model.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - ControlLoRA
**ID:** `field_list_builder_controllora`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, controllora

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - ControlNet
**ID:** `field_list_builder_controlnet`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, controlnet

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Float
**ID:** `field_list_builder_float`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, float

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `value` | `float` | The value for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Float Collection
**ID:** `field_list_builder_float_collection`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, float, collection

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `collection` | `list[float]` | The collection for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - FLUX Main Model
**ID:** `field_list_builder_flux_main_model`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, flux, main, model

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries, for a main model.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - FLUX VAE
**ID:** `field_list_builder_flux_vae`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, vae, flux

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries, for a VAE model.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Image
**ID:** `field_list_builder_image`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, image

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `value` | `ImageField` | The value for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Image Collection
**ID:** `field_list_builder_image_collection`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, image, collection

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `collection` | `list[ImageField]` | The image collection for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Integer
**ID:** `field_list_builder_integer`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, integer

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `value` | `int` | The value for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Integer Collection
**ID:** `field_list_builder_integer_collection`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, integer, collection

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `collection` | `list[int]` | The collection for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - IP Adapter
**ID:** `field_list_builder_ip_adapter`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, ip, adapter

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - Join
**ID:** `field_list_builder_join`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, join, concatenate

**Version:** 1.0.0

**Description:** Concatenates two JSON lists.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `first` | `str` | The first JSON field list for joining. | None |
| `second` | `str` | The second JSON field list for joining. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - LoRA
**ID:** `field_list_builder_lora`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, lora

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - String
**ID:** `field_list_builder_string`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, string

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `value` | `str` | The value for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - String Collection
**ID:** `field_list_builder_string_collection`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, string, collection

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `collection` | `list[str]` | The collection for the new entry. | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---
### Field List Builder - T5 Model
**ID:** `field_list_builder_t5_model`

**Category:** utilities

**Tags:** json, field, workflow, list, utility, t5, encoder

**Version:** 1.0.0

**Description:** Builds or appends to a JSON list containing single key-value pair dictionaries, for a T5 encoder model.

<details>
<summary>

#### Inputs

</summary>

| Name | Type | Description | Default |
| ---- | ---- | ----------- | ------- |
| `model` | `ModelIdentifierField` |  | None |


</details>

<details>
<summary>

#### Output

</summary>

No output information available.


</details>

---

## Footnotes
For questions/comments/concerns/etc, use github or drop into the InvokeAI discord where you'll probably find someone who can help.
